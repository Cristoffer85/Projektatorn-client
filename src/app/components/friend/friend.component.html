<h5>Friends</h5>
<ul class="list-group mb-4">
  <li *ngIf="isLoadingFriends" class="list-group-item text-muted">
    Loading friends...
  </li>
  <li
    *ngFor="let friend of friends"
    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
    [class.active]="selectedFriend === friend.username"
    [class.bg-danger]="hasUnreadFrom(friend.username)"
    [class.text-white]="hasUnreadFrom(friend.username)"
    (click)="selectFriend(friend)"
    style="cursor:pointer"
  >
    <span>{{ friend.username }}</span>
    <button
      class="btn btn-sm btn-outline-danger ms-2"
      (click)="removeFriend(friend.username, $event)"
      title="Remove friend"
    >
      Remove
    </button>
  </li>
</ul>

<h6>All Users</h6>
<ul class="list-group mb-4">
  <li *ngFor="let user of filteredAllUsers" class="list-group-item d-flex justify-content-between align-items-center">
    {{ user.username }}
    <button
      class="btn btn-sm btn-outline-primary"
      (click)="sendFriendRequest(user.username)"
      [disabled]="isFriend(user.username) || hasOutgoingRequest(user.username)"
    >
      {{ isFriend(user.username) ? 'Friend' : hasOutgoingRequest(user.username) ? 'Requested' : 'Add Friend' }}
    </button>
  </li>
</ul>

<h6>Friend Requests</h6>
<ul class="list-group">
  <li *ngFor="let req of friendRequests" class="list-group-item d-flex justify-content-between align-items-center">
    {{ req.username }}
    <div>
      <button class="btn btn-sm btn-success me-1" (click)="respondToRequest(req.requestId, true)">Accept</button>
      <button class="btn btn-sm btn-danger" (click)="respondToRequest(req.requestId, false)">Reject</button>
    </div>
  </li>
</ul>